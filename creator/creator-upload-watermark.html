<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ - UGC Maroc</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Symbols+Outlined" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; }
        .upload-area {
            border: 2px dashed #d1d5db;
            transition: all 0.3s ease;
        }
        .upload-area.dragover {
            border-color: #3b82f6;
            background-color: #eff6ff;
        }
        .watermark-info {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 1px solid #f59e0b;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <h1 class="text-xl font-bold text-gray-900">Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</h1>
                </div>
                <div class="flex items-center space-x-4 space-x-reverse">
                    <span class="text-sm text-gray-500">Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ø§Ù„Ù…Ø¨Ø¯Ø¹</span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-4xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
        <!-- Watermark Info Panel -->
        <div class="watermark-info rounded-lg p-4 mb-6">
            <div class="flex items-start space-x-3 space-x-reverse">
                <span class="material-symbols-outlined text-amber-600 text-2xl">security</span>
                <div>
                    <h3 class="font-bold text-amber-900 mb-2">ğŸ”’ Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬</h3>
                    <p class="text-sm text-amber-800 mb-2">
                        ÙÙŠØ¯ÙŠÙˆÙƒ Ø³ÙŠÙƒÙˆÙ† Ù…Ø­Ù…ÙŠØ§Ù‹ Ø¨Ø¹Ù„Ø§Ù…Ø© Ù…Ø§Ø¦ÙŠØ© "PREVIEW" Ø­ØªÙ‰ Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ© ÙˆØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¯ÙØ¹
                    </p>
                    <ul class="text-xs text-amber-700 space-y-1">
                        <li>â€¢ Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø§Ø¦ÙŠØ© ØªÙ…Ù†Ø¹ Ø³Ø±Ù‚Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù‚Ø¨Ù„ Ø§Ù„Ø¯ÙØ¹</li>
                        <li>â€¢ Ø¨Ø¹Ø¯ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© ÙˆØ§Ù„Ø¯ÙØ¹ØŒ Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø§Ø¦ÙŠØ© ØªØ®ØªÙÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</li>
                        <li>â€¢ Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ© ØªØ­ØªÙØ¸ Ø¨Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù†Ø´Ø± Ø¹Ù„Ù‰ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Upload Form -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-bold text-gray-900 mb-4">Ø±ÙØ¹ ÙÙŠØ¯ÙŠÙˆ Ø¬Ø¯ÙŠØ¯</h2>
            
            <!-- Campaign Selection -->
            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ø®ØªØ± Ø§Ù„Ø­Ù…Ù„Ø©</label>
                <select id="campaignSelect" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="">Ø§Ø®ØªØ± Ø­Ù…Ù„Ø©...</option>
                    <option value="1">Ø­Ù…Ù„Ø© Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ØªØ¬Ù…ÙŠÙ„ - Marjane</option>
                    <option value="2">Ø­Ù…Ù„Ø© Ø§Ù„Ø£Ø²ÙŠØ§Ø¡ - Zara</option>
                    <option value="3">Ø­Ù…Ù„Ø© Ø§Ù„Ø·Ø¹Ø§Ù… - McDonald's</option>
                </select>
            </div>

            <!-- Video Upload Area -->
            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</label>
                <div id="uploadArea" class="upload-area rounded-lg p-8 text-center cursor-pointer">
                    <div class="space-y-4">
                        <span class="material-symbols-outlined text-4xl text-gray-400">cloud_upload</span>
                        <div>
                            <p class="text-lg font-medium text-gray-900">Ø§Ø³Ø­Ø¨ ÙˆØ£ÙÙ„Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù‡Ù†Ø§</p>
                            <p class="text-sm text-gray-500">Ø£Ùˆ Ø§Ù†Ù‚Ø± Ù„Ù„Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ø§Ù„Ø¬Ù‡Ø§Ø²</p>
                        </div>
                        <div class="text-xs text-gray-400">
                            <p>Ø§Ù„ØµÙŠØº Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø©: MP4, MOV, AVI</p>
                            <p>Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø£Ù‚ØµÙ‰: 500 MB</p>
                        </div>
                    </div>
                    <input type="file" id="videoFile" accept="video/*" class="hidden">
                </div>
            </div>

            <!-- Video Preview -->
            <div id="videoPreview" class="mb-6 hidden">
                <label class="block text-sm font-medium text-gray-700 mb-2">Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</label>
                <div class="relative">
                    <video id="previewVideo" class="w-full h-64 bg-gray-100 rounded-lg" controls>
                        Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
                    </video>
                    <div class="absolute top-2 right-2 bg-red-600 text-white px-2 py-1 rounded text-xs font-bold">
                        PREVIEW
                    </div>
                </div>
                <p class="text-xs text-gray-500 mt-2">
                    âš ï¸ Ù‡Ø°Ø§ Ù…Ø§ Ø³ØªØ±Ø§Ù‡ Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ© (Ù…Ø¹ Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø§Ø¦ÙŠØ©) Ø­ØªÙ‰ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©
                </p>
            </div>

            <!-- Upload Progress -->
            <div id="uploadProgress" class="mb-6 hidden">
                <div class="bg-gray-200 rounded-full h-2">
                    <div id="progressBar" class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                </div>
                <p id="progressText" class="text-sm text-gray-600 mt-2">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±ÙØ¹...</p>
            </div>

            <!-- Upload Button -->
            <div class="flex justify-end space-x-4 space-x-reverse">
                <button id="uploadBtn" onclick="uploadVideo()" 
                        class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"
                        disabled>
                    Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
                </button>
            </div>
        </div>

        <!-- Recent Submissions -->
        <div class="mt-8">
            <h3 class="text-lg font-bold text-gray-900 mb-4">ØªÙ‚Ø¯ÙŠÙ…Ø§ØªÙŠ Ø§Ù„Ø£Ø®ÙŠØ±Ø©</h3>
            <div class="grid gap-4 md:grid-cols-2">
                <!-- Submission 1 -->
                <div class="bg-white rounded-lg shadow-md p-4">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-semibold text-gray-900">ÙÙŠØ¯ÙŠÙˆ ØªØ¬Ù…ÙŠÙ„ - Ø¢Ù…Ù†Ø©</h4>
                        <span class="px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full">ÙÙŠ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">Ø­Ù…Ù„Ø©: Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ØªØ¬Ù…ÙŠÙ„</p>
                    <div class="text-xs text-gray-500">
                        <p>ğŸ”’ Ù…Ø­Ù…ÙŠ Ø¨Ø¹Ù„Ø§Ù…Ø© Ù…Ø§Ø¦ÙŠØ© Ø­ØªÙ‰ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©</p>
                        <p>ØªÙ… Ø§Ù„Ø±ÙØ¹: Ù…Ù†Ø° Ø³Ø§Ø¹ØªÙŠÙ†</p>
                    </div>
                </div>

                <!-- Submission 2 -->
                <div class="bg-white rounded-lg shadow-md p-4">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-semibold text-gray-900">ÙÙŠØ¯ÙŠÙˆ Ø£Ø²ÙŠØ§Ø¡ - ÙØ§Ø·Ù…Ø©</h4>
                        <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Ù…ÙˆØ§ÙÙ‚</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">Ø­Ù…Ù„Ø©: Ø§Ù„Ø£Ø²ÙŠØ§Ø¡ Ø§Ù„ØµÙŠÙÙŠØ©</p>
                    <div class="text-xs text-gray-500">
                        <p>âœ… ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© ÙˆØ¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø§Ø¦ÙŠØ©</p>
                        <p>ØªÙ… Ø§Ù„Ø±ÙØ¹: Ù…Ù†Ø° ÙŠÙˆÙ…</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let selectedFile = null;
        let selectedCampaign = null;

        // Initialize upload area
        document.addEventListener('DOMContentLoaded', function() {
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('videoFile');
            const campaignSelect = document.getElementById('campaignSelect');

            // Click to select file
            uploadArea.addEventListener('click', () => fileInput.click());

            // Drag and drop
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });

            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFileSelect(files[0]);
                }
            });

            // File input change
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleFileSelect(e.target.files[0]);
                }
            });

            // Campaign selection
            campaignSelect.addEventListener('change', (e) => {
                selectedCampaign = e.target.value;
                updateUploadButton();
            });
        });

        function handleFileSelect(file) {
            if (!file.type.startsWith('video/')) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù ÙÙŠØ¯ÙŠÙˆ ØµØ§Ù„Ø­');
                return;
            }

            if (file.size > 500 * 1024 * 1024) { // 500MB
                alert('Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹. Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 500 MB');
                return;
            }

            selectedFile = file;
            showVideoPreview(file);
            updateUploadButton();
        }

        function showVideoPreview(file) {
            const previewDiv = document.getElementById('videoPreview');
            const previewVideo = document.getElementById('previewVideo');
            
            const url = URL.createObjectURL(file);
            previewVideo.src = url;
            previewDiv.classList.remove('hidden');
        }

        function updateUploadButton() {
            const uploadBtn = document.getElementById('uploadBtn');
            uploadBtn.disabled = !selectedFile || !selectedCampaign;
        }

        async function uploadVideo() {
            if (!selectedFile || !selectedCampaign) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙˆØ§Ù„Ø­Ù…Ù„Ø©');
                return;
            }

            const formData = new FormData();
            formData.append('video', selectedFile);
            formData.append('campaignId', selectedCampaign);
            formData.append('campaignName', document.getElementById('campaignSelect').selectedOptions[0].text);

            // Show progress
            const progressDiv = document.getElementById('uploadProgress');
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            
            progressDiv.classList.remove('hidden');
            progressBar.style.width = '0%';
            progressText.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±ÙØ¹...';

            try {
                const response = await fetch('/api/upload-video', {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (data.success) {
                    progressBar.style.width = '100%';
                    progressText.textContent = 'ØªÙ… Ø§Ù„Ø±ÙØ¹ Ø¨Ù†Ø¬Ø§Ø­!';
                    
                    alert('ØªÙ… Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ù†Ø¬Ø§Ø­ Ù…Ø¹ Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬Ø©! ğŸ‰\n\n' +
                          'ÙÙŠØ¯ÙŠÙˆÙƒ Ù…Ø­Ù…ÙŠ Ø¨Ø¹Ù„Ø§Ù…Ø© Ù…Ø§Ø¦ÙŠØ© Ø­ØªÙ‰ Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ© ÙˆØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¯ÙØ¹.');
                    
                    // Reset form
                    selectedFile = null;
                    selectedCampaign = null;
                    document.getElementById('videoPreview').classList.add('hidden');
                    document.getElementById('uploadProgress').classList.add('hidden');
                    document.getElementById('videoFile').value = '';
                    document.getElementById('campaignSelect').value = '';
                    updateUploadButton();
                } else {
                    throw new Error(data.message);
                }
            } catch (error) {
                console.error('Upload error:', error);
                alert('Ø®Ø·Ø£ ÙÙŠ Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ: ' + error.message);
                progressDiv.classList.add('hidden');
            }
        }
    </script>

  <!-- Cookie System Integration -->
  <script src="/js/cookie-manager.js"></script>
  <script src="/js/cookie-banner.js"></script>
  <script src="/js/cookie-integration.js"></script>
</body>
</html>
